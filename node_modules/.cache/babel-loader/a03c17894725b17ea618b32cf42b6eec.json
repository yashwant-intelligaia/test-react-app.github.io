{"ast":null,"code":"\"use strict\";\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nvar colCache = require('../utils/col-cache');\n\nvar Anchor = require('./anchor');\n\nvar Image = /*#__PURE__*/function () {\n  function Image(worksheet, model) {\n    _classCallCheck(this, Image);\n\n    this.worksheet = worksheet;\n    this.model = model;\n  }\n\n  _createClass(Image, [{\n    key: \"model\",\n    get: function get() {\n      switch (this.type) {\n        case 'background':\n          return {\n            type: this.type,\n            imageId: this.imageId\n          };\n\n        case 'image':\n          return {\n            type: this.type,\n            imageId: this.imageId,\n            hyperlinks: this.range.hyperlinks,\n            range: {\n              tl: this.range.tl.model,\n              br: this.range.br && this.range.br.model,\n              ext: this.range.ext,\n              editAs: this.range.editAs\n            }\n          };\n\n        default:\n          throw new Error('Invalid Image Type');\n      }\n    },\n    set: function set(_ref) {\n      var type = _ref.type,\n          imageId = _ref.imageId,\n          range = _ref.range,\n          hyperlinks = _ref.hyperlinks;\n      this.type = type;\n      this.imageId = imageId;\n\n      if (type === 'image') {\n        if (typeof range === 'string') {\n          var decoded = colCache.decode(range);\n          this.range = {\n            tl: new Anchor(this.worksheet, {\n              col: decoded.left,\n              row: decoded.top\n            }, -1),\n            br: new Anchor(this.worksheet, {\n              col: decoded.right,\n              row: decoded.bottom\n            }, 0),\n            editAs: 'oneCell'\n          };\n        } else {\n          this.range = {\n            tl: new Anchor(this.worksheet, range.tl, 0),\n            br: range.br && new Anchor(this.worksheet, range.br, 0),\n            ext: range.ext,\n            editAs: range.editAs,\n            hyperlinks: hyperlinks || range.hyperlinks\n          };\n        }\n      }\n    }\n  }]);\n\n  return Image;\n}();\n\nmodule.exports = Image;","map":{"version":3,"sources":["../../../lib/doc/image.js"],"names":["colCache","require","Anchor","Image","type","imageId","hyperlinks","range","tl","br","ext","editAs","decoded","col","row","top","bottom","module"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAxB,oBAAwB,CAAxB;;AACA,IAAMC,MAAM,GAAGD,OAAO,CAAtB,UAAsB,CAAtB;;IAEME,K;AACJ,WAAA,KAAA,CAAA,SAAA,EAAA,KAAA,EAA8B;AAAA,IAAA,eAAA,CAAA,IAAA,EAAA,KAAA,CAAA;;AAC5B,SAAA,SAAA,GAAA,SAAA;AACA,SAAA,KAAA,GAAA,KAAA;AACD;;;;wBAEW;AACV,cAAQ,KAAR,IAAA;AACE,aAAA,YAAA;AACE,iBAAO;AACLC,YAAAA,IAAI,EAAE,KADD,IAAA;AAELC,YAAAA,OAAO,EAAE,KAAKA;AAFT,WAAP;;AAIF,aAAA,OAAA;AACE,iBAAO;AACLD,YAAAA,IAAI,EAAE,KADD,IAAA;AAELC,YAAAA,OAAO,EAAE,KAFJ,OAAA;AAGLC,YAAAA,UAAU,EAAE,KAAA,KAAA,CAHP,UAAA;AAILC,YAAAA,KAAK,EAAE;AACLC,cAAAA,EAAE,EAAE,KAAA,KAAA,CAAA,EAAA,CADC,KAAA;AAELC,cAAAA,EAAE,EAAE,KAAA,KAAA,CAAA,EAAA,IAAiB,KAAA,KAAA,CAAA,EAAA,CAFhB,KAAA;AAGLC,cAAAA,GAAG,EAAE,KAAA,KAAA,CAHA,GAAA;AAILC,cAAAA,MAAM,EAAE,KAAA,KAAA,CAAWA;AAJd;AAJF,WAAP;;AAWF;AACE,gBAAM,IAAA,KAAA,CAAN,oBAAM,CAAN;AAnBJ;;4BAuB4C;AAAA,UAAnCP,IAAmC,GAAA,IAAA,CAAnCA,IAAmC;AAAA,UAA7BC,OAA6B,GAAA,IAAA,CAA7BA,OAA6B;AAAA,UAApBE,KAAoB,GAAA,IAAA,CAApBA,KAAoB;AAAA,UAAbD,UAAa,GAAA,IAAA,CAAbA,UAAa;AAC5C,WAAA,IAAA,GAAA,IAAA;AACA,WAAA,OAAA,GAAA,OAAA;;AAEA,UAAIF,IAAI,KAAR,OAAA,EAAsB;AACpB,YAAI,OAAA,KAAA,KAAJ,QAAA,EAA+B;AAC7B,cAAMQ,OAAO,GAAGZ,QAAQ,CAARA,MAAAA,CAAhB,KAAgBA,CAAhB;AACA,eAAA,KAAA,GAAa;AACXQ,YAAAA,EAAE,EAAE,IAAA,MAAA,CAAW,KAAX,SAAA,EAA2B;AAACK,cAAAA,GAAG,EAAED,OAAO,CAAb,IAAA;AAAoBE,cAAAA,GAAG,EAAEF,OAAO,CAACG;AAAjC,aAA3B,EAAkE,CAD3D,CACP,CADO;AAEXN,YAAAA,EAAE,EAAE,IAAA,MAAA,CAAW,KAAX,SAAA,EAA2B;AAACI,cAAAA,GAAG,EAAED,OAAO,CAAb,KAAA;AAAqBE,cAAAA,GAAG,EAAEF,OAAO,CAACI;AAAlC,aAA3B,EAFO,CAEP,CAFO;AAGXL,YAAAA,MAAM,EAAE;AAHG,WAAb;AAFF,SAAA,MAOO;AACL,eAAA,KAAA,GAAa;AACXH,YAAAA,EAAE,EAAE,IAAA,MAAA,CAAW,KAAX,SAAA,EAA2BD,KAAK,CAAhC,EAAA,EADO,CACP,CADO;AAEXE,YAAAA,EAAE,EAAEF,KAAK,CAALA,EAAAA,IAAY,IAAA,MAAA,CAAW,KAAX,SAAA,EAA2BA,KAAK,CAAhC,EAAA,EAFL,CAEK,CAFL;AAGXG,YAAAA,GAAG,EAAEH,KAAK,CAHC,GAAA;AAIXI,YAAAA,MAAM,EAAEJ,KAAK,CAJF,MAAA;AAKXD,YAAAA,UAAU,EAAEA,UAAU,IAAIC,KAAK,CAACD;AALrB,WAAb;AAOD;AACF;AACF;;;;;;AAGHW,MAAM,CAANA,OAAAA,GAAAA,KAAAA","sourcesContent":["const colCache = require('../utils/col-cache');\r\nconst Anchor = require('./anchor');\r\n\r\nclass Image {\r\n  constructor(worksheet, model) {\r\n    this.worksheet = worksheet;\r\n    this.model = model;\r\n  }\r\n\r\n  get model() {\r\n    switch (this.type) {\r\n      case 'background':\r\n        return {\r\n          type: this.type,\r\n          imageId: this.imageId,\r\n        };\r\n      case 'image':\r\n        return {\r\n          type: this.type,\r\n          imageId: this.imageId,\r\n          hyperlinks: this.range.hyperlinks,\r\n          range: {\r\n            tl: this.range.tl.model,\r\n            br: this.range.br && this.range.br.model,\r\n            ext: this.range.ext,\r\n            editAs: this.range.editAs,\r\n          },\r\n        };\r\n      default:\r\n        throw new Error('Invalid Image Type');\r\n    }\r\n  }\r\n\r\n  set model({type, imageId, range, hyperlinks}) {\r\n    this.type = type;\r\n    this.imageId = imageId;\r\n\r\n    if (type === 'image') {\r\n      if (typeof range === 'string') {\r\n        const decoded = colCache.decode(range);\r\n        this.range = {\r\n          tl: new Anchor(this.worksheet, {col: decoded.left, row: decoded.top}, -1),\r\n          br: new Anchor(this.worksheet, {col: decoded.right, row: decoded.bottom}, 0),\r\n          editAs: 'oneCell',\r\n        };\r\n      } else {\r\n        this.range = {\r\n          tl: new Anchor(this.worksheet, range.tl, 0),\r\n          br: range.br && new Anchor(this.worksheet, range.br, 0),\r\n          ext: range.ext,\r\n          editAs: range.editAs,\r\n          hyperlinks: hyperlinks || range.hyperlinks,\r\n        };\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = Image;\r\n"]},"metadata":{},"sourceType":"script"}