{"ast":null,"code":"'use strict';\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nvar colCache = require('../utils/col-cache');\n\nvar Anchor = /*#__PURE__*/function () {\n  function Anchor(worksheet, address) {\n    var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n    _classCallCheck(this, Anchor);\n\n    if (!address) {\n      this.nativeCol = 0;\n      this.nativeColOff = 0;\n      this.nativeRow = 0;\n      this.nativeRowOff = 0;\n    } else if (typeof address === 'string') {\n      var decoded = colCache.decodeAddress(address);\n      this.nativeCol = decoded.col + offset;\n      this.nativeColOff = 0;\n      this.nativeRow = decoded.row + offset;\n      this.nativeRowOff = 0;\n    } else if (address.nativeCol !== undefined) {\n      this.nativeCol = address.nativeCol || 0;\n      this.nativeColOff = address.nativeColOff || 0;\n      this.nativeRow = address.nativeRow || 0;\n      this.nativeRowOff = address.nativeRowOff || 0;\n    } else if (address.col !== undefined) {\n      this.col = address.col + offset;\n      this.row = address.row + offset;\n    } else {\n      this.nativeCol = 0;\n      this.nativeColOff = 0;\n      this.nativeRow = 0;\n      this.nativeRowOff = 0;\n    }\n\n    this.worksheet = worksheet;\n  }\n\n  _createClass(Anchor, [{\n    key: \"col\",\n    get: function get() {\n      return this.nativeCol + Math.min(this.colWidth - 1, this.nativeColOff) / this.colWidth;\n    },\n    set: function set(v) {\n      this.nativeCol = Math.floor(v);\n      this.nativeColOff = Math.floor((v - this.nativeCol) * this.colWidth);\n    }\n  }, {\n    key: \"row\",\n    get: function get() {\n      return this.nativeRow + Math.min(this.rowHeight - 1, this.nativeRowOff) / this.rowHeight;\n    },\n    set: function set(v) {\n      this.nativeRow = Math.floor(v);\n      this.nativeRowOff = Math.floor((v - this.nativeRow) * this.rowHeight);\n    }\n  }, {\n    key: \"colWidth\",\n    get: function get() {\n      return this.worksheet && this.worksheet.getColumn(this.nativeCol + 1) && this.worksheet.getColumn(this.nativeCol + 1).isCustomWidth ? Math.floor(this.worksheet.getColumn(this.nativeCol + 1).width * 10000) : 640000;\n    }\n  }, {\n    key: \"rowHeight\",\n    get: function get() {\n      return this.worksheet && this.worksheet.getRow(this.nativeRow + 1) && this.worksheet.getRow(this.nativeRow + 1).height ? Math.floor(this.worksheet.getRow(this.nativeRow + 1).height * 10000) : 180000;\n    }\n  }, {\n    key: \"model\",\n    get: function get() {\n      return {\n        nativeCol: this.nativeCol,\n        nativeColOff: this.nativeColOff,\n        nativeRow: this.nativeRow,\n        nativeRowOff: this.nativeRowOff\n      };\n    },\n    set: function set(value) {\n      this.nativeCol = value.nativeCol;\n      this.nativeColOff = value.nativeColOff;\n      this.nativeRow = value.nativeRow;\n      this.nativeRowOff = value.nativeRowOff;\n    }\n  }], [{\n    key: \"asInstance\",\n    value: function asInstance(model) {\n      return model instanceof Anchor || model == null ? model : new Anchor(model);\n    }\n  }]);\n\n  return Anchor;\n}();\n\nmodule.exports = Anchor;","map":{"version":3,"sources":["../../../lib/doc/anchor.js"],"names":["colCache","require","Anchor","offset","decoded","address","model","Math","v","nativeCol","nativeColOff","nativeRow","nativeRowOff","value","module"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nconst colCache = require('../utils/col-cache');\r\n\r\nclass Anchor {\r\n  constructor(worksheet, address, offset = 0) {\r\n    if (!address) {\r\n      this.nativeCol = 0;\r\n      this.nativeColOff = 0;\r\n      this.nativeRow = 0;\r\n      this.nativeRowOff = 0;\r\n    } else if (typeof address === 'string') {\r\n      const decoded = colCache.decodeAddress(address);\r\n      this.nativeCol = decoded.col + offset;\r\n      this.nativeColOff = 0;\r\n      this.nativeRow = decoded.row + offset;\r\n      this.nativeRowOff = 0;\r\n    } else if (address.nativeCol !== undefined) {\r\n      this.nativeCol = address.nativeCol || 0;\r\n      this.nativeColOff = address.nativeColOff || 0;\r\n      this.nativeRow = address.nativeRow || 0;\r\n      this.nativeRowOff = address.nativeRowOff || 0;\r\n    } else if (address.col !== undefined) {\r\n      this.col = address.col + offset;\r\n      this.row = address.row + offset;\r\n    } else {\r\n      this.nativeCol = 0;\r\n      this.nativeColOff = 0;\r\n      this.nativeRow = 0;\r\n      this.nativeRowOff = 0;\r\n    }\r\n\r\n    this.worksheet = worksheet;\r\n  }\r\n\r\n  static asInstance(model) {\r\n    return model instanceof Anchor || model == null ? model : new Anchor(model);\r\n  }\r\n\r\n  get col() {\r\n    return this.nativeCol + Math.min(this.colWidth - 1, this.nativeColOff) / this.colWidth;\r\n  }\r\n\r\n  set col(v) {\r\n    this.nativeCol = Math.floor(v);\r\n    this.nativeColOff = Math.floor((v - this.nativeCol) * this.colWidth);\r\n  }\r\n\r\n  get row() {\r\n    return this.nativeRow + Math.min(this.rowHeight - 1, this.nativeRowOff) / this.rowHeight;\r\n  }\r\n\r\n  set row(v) {\r\n    this.nativeRow = Math.floor(v);\r\n    this.nativeRowOff = Math.floor((v - this.nativeRow) * this.rowHeight);\r\n  }\r\n\r\n  get colWidth() {\r\n    return this.worksheet &&\r\n      this.worksheet.getColumn(this.nativeCol + 1) &&\r\n      this.worksheet.getColumn(this.nativeCol + 1).isCustomWidth\r\n      ? Math.floor(this.worksheet.getColumn(this.nativeCol + 1).width * 10000)\r\n      : 640000;\r\n  }\r\n\r\n  get rowHeight() {\r\n    return this.worksheet &&\r\n      this.worksheet.getRow(this.nativeRow + 1) &&\r\n      this.worksheet.getRow(this.nativeRow + 1).height\r\n      ? Math.floor(this.worksheet.getRow(this.nativeRow + 1).height * 10000)\r\n      : 180000;\r\n  }\r\n\r\n  get model() {\r\n    return {\r\n      nativeCol: this.nativeCol,\r\n      nativeColOff: this.nativeColOff,\r\n      nativeRow: this.nativeRow,\r\n      nativeRowOff: this.nativeRowOff,\r\n    };\r\n  }\r\n\r\n  set model(value) {\r\n    this.nativeCol = value.nativeCol;\r\n    this.nativeColOff = value.nativeColOff;\r\n    this.nativeRow = value.nativeRow;\r\n    this.nativeRowOff = value.nativeRowOff;\r\n  }\r\n}\r\n\r\nmodule.exports = Anchor;\r\n"]},"metadata":{},"sourceType":"script"}